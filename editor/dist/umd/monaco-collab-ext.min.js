/**!
Â© 2019 Convergence Labs, Inc.
@version 0.3.2
@license MIT
*/
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("monaco-editor")):"function"==typeof define&&define.amd?define("MonacoCollabExt",["vs/editor/editor.main"],e):"object"==typeof exports?exports.MonacoCollabExt=e(require("monaco-editor")):t.MonacoCollabExt=e(t.monaco)}(self,e=>(()=>{"use strict";var i={22:function(t,e,o){var i=this&&this.__createBinding||(Object.create?function(t,e,o,i){void 0===i&&(i=o);var s=Object.getOwnPropertyDescriptor(e,o);s&&("get"in s?e.__esModule:!s.writable&&!s.configurable)||(s={enumerable:!0,get:function(){return e[o]}}),Object.defineProperty(t,i,s)}:function(t,e,o,i){t[i=void 0===i?o:i]=e[o]}),s=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),n=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var o in t)"default"!==o&&Object.prototype.hasOwnProperty.call(t,o)&&i(e,t,o);return s(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.EditorContentManager=void 0;const r=n(o(643)),d=o(422);class a{constructor(t){this._onContentChanged=t=>{this._suppress||t.changes.forEach(t=>this._processChange(t))},this._options=Object.assign(Object.assign({},a._DEFAULTS),t),d.Validation.assertDefined(this._options,"options"),d.Validation.assertDefined(this._options.editor,"options.editor"),d.Validation.assertFunction(this._options.onInsert,"options.onInsert"),d.Validation.assertFunction(this._options.onReplace,"options.onReplace"),d.Validation.assertFunction(this._options.onDelete,"options.onDelete"),this._disposer=this._options.editor.onDidChangeModelContent(this._onContentChanged)}insert(t,e){this._suppress=!0;const{editor:o,remoteSourceId:i}=this._options;t=o.getModel().getPositionAt(t);o.executeEdits(i,[{range:new r.Range(t.lineNumber,t.column,t.lineNumber,t.column),text:e,forceMoveMarkers:!0}]),this._suppress=!1}replace(t,e,o){this._suppress=!0;const{editor:i,remoteSourceId:s}=this._options;var n=i.getModel().getPositionAt(t),t=i.getModel().getPositionAt(t+e);i.executeEdits(s,[{range:new r.Range(n.lineNumber,n.column,t.lineNumber,t.column),text:o,forceMoveMarkers:!0}]),this._suppress=!1}delete(t,e){this._suppress=!0;const{editor:o,remoteSourceId:i}=this._options;var s=o.getModel().getPositionAt(t),t=o.getModel().getPositionAt(t+e);o.executeEdits(i,[{range:new r.Range(s.lineNumber,s.column,t.lineNumber,t.column),text:"",forceMoveMarkers:!0}]),this._suppress=!1}dispose(){this._disposer.dispose()}_processChange(t){d.Validation.assertDefined(t,"change");var{rangeOffset:e,rangeLength:o,text:i}=t;if(0<i.length&&0===o)this._options.onInsert(e,i);else if(0<i.length&&0<o)this._options.onReplace(e,o,i);else{if(!(0===i.length&&0<o))throw new Error("Unexpected change: "+JSON.stringify(t));this._options.onDelete(e,o)}}}(e.EditorContentManager=a)._DEFAULTS={onInsert:()=>{},onReplace:()=>{},onDelete:()=>{},remoteSourceId:"remote"}},741:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.RemoteCursor=void 0;e.RemoteCursor=class{constructor(t){this._delegate=t}getId(){return this._delegate.getId()}getPosition(){return this._delegate.getPosition().position}setPosition(t){this._delegate.setPosition(t)}setOffset(t){this._delegate.setOffset(t)}show(){this._delegate.show()}hide(){this._delegate.hide()}isDisposed(){return this._delegate.isDisposed()}dispose(){this._delegate.dispose()}}},423:(t,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.RemoteCursorManager=void 0;const n=o(741),r=o(282),d=o(422);class i{constructor(t){if("object"!=typeof t)throw new Error("'options' is a required parameter and must be an object.");if(void 0===(t=Object.assign(Object.assign({},i.DEFAULT_OPTIONS),t)).editor||null===t.editor)throw new Error("options.editor must be defined but was: "+t.editor);this._options=t,this._cursorWidgets=new Map,this._nextWidgetId=0}addCursor(t,e,o){d.Validation.assertString(t,"id"),d.Validation.assertString(e,"color"),this._options.tooltips;var i=""+this._nextWidgetId++,s=1e3*this._options.tooltipDuration,i=new r.RemoteCursorWidget(this._options.editor,i,e,o,this._options.tooltips,s,()=>this.removeCursor(t));return this._cursorWidgets.set(t,i),new n.RemoteCursor(i)}removeCursor(t){d.Validation.assertString(t,"id");const e=this._getCursor(t);e.isDisposed()||e.dispose(),this._cursorWidgets.delete(t)}setCursorPosition(t,e){d.Validation.assertString(t,"id");const o=this._getCursor(t);o.setPosition(e)}setCursorOffset(t,e){d.Validation.assertString(t,"id");const o=this._getCursor(t);o.setOffset(e)}showCursor(t){d.Validation.assertString(t,"id");const e=this._getCursor(t);e.show()}hideCursor(t){d.Validation.assertString(t,"id");const e=this._getCursor(t);e.hide()}_getCursor(t){if(this._cursorWidgets.has(t))return this._cursorWidgets.get(t);throw new Error("No such cursor: "+t)}}(e.RemoteCursorManager=i).DEFAULT_OPTIONS={tooltips:!0,tooltipDuration:1}},282:(t,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.RemoteCursorWidget=void 0;const d=o(643),a=o(22),i=o(422);e.RemoteCursorWidget=class{constructor(t,e,o,i,s,n,r){this._onInsert=(t,e)=>{null!==this._position&&t<=(t=this._offset)&&(t=t+e.length,e=this._editor.getModel().getPositionAt(t),this._updatePosition(e))},this._onReplace=(t,e,o)=>{var i;null!==this._position&&t<=(i=this._offset)&&(i=i-Math.min(i-t,e)+o.length,t=this._editor.getModel().getPositionAt(i),this._updatePosition(t))},this._onDelete=(t,e)=>{var o;null!==this._position&&t<=(o=this._offset)&&(o=o-Math.min(o-t,e),t=this._editor.getModel().getPositionAt(o),this._updatePosition(t))},this._editor=t,this._tooltipDuration=n,this._id="monaco-remote-cursor-"+e,this._onDisposed=r;n=("function"==typeof(t=this._editor).getConfiguration?t.getConfiguration():{lineHeight:t.getOption(d.editor.EditorOption.lineHeight)}).lineHeight;this._domNode=document.createElement("div"),this._domNode.className="monaco-remote-cursor",this._domNode.style.background=o,this._domNode.style.height=n+"px",s?(this._tooltipNode=document.createElement("div"),this._tooltipNode.className="monaco-remote-cursor-tooltip",this._tooltipNode.style.background=o,this._tooltipNode.innerHTML=i,this._domNode.appendChild(this._tooltipNode),this._scrollListener=this._editor.onDidScrollChange(()=>{this._updateTooltipPosition()})):(this._tooltipNode=null,this._scrollListener=null),this._contentManager=new a.EditorContentManager({editor:this._editor,onInsert:this._onInsert,onReplace:this._onReplace,onDelete:this._onDelete}),this._hideTimer=null,this._editor.addContentWidget(this),this._offset=-1,this._disposed=!1}hide(){this._domNode.style.display="none"}show(){this._domNode.style.display="inherit"}setOffset(t){i.Validation.assertNumber(t,"offset");t=this._editor.getModel().getPositionAt(t);this.setPosition(t)}setPosition(t){i.Validation.assertPosition(t,"position"),this._updatePosition(t),null!==this._tooltipNode&&setTimeout(()=>this._showTooltip(),0)}isDisposed(){return this._disposed}dispose(){this._disposed||(this._editor.removeContentWidget(this),null!==this._scrollListener&&this._scrollListener.dispose(),this._contentManager.dispose(),this._disposed=!0,this._onDisposed())}getId(){return this._id}getDomNode(){return this._domNode}getPosition(){return this._position}_updatePosition(t){this._position={position:Object.assign({},t),preference:[d.editor.ContentWidgetPositionPreference.EXACT]},this._offset=this._editor.getModel().getOffsetAt(t),this._editor.layoutContentWidget(this)}_showTooltip(){this._updateTooltipPosition(),null!==this._hideTimer?clearTimeout(this._hideTimer):this._setTooltipVisible(!0),this._hideTimer=setTimeout(()=>{this._setTooltipVisible(!1),this._hideTimer=null},this._tooltipDuration)}_updateTooltipPosition(){this._domNode.offsetTop-this._editor.getScrollTop()-this._tooltipNode.offsetHeight<5?this._tooltipNode.style.top=this._tooltipNode.offsetHeight+2+"px":this._tooltipNode.style.top=`-${this._tooltipNode.offsetHeight}px`,this._tooltipNode.style.left="0"}_setTooltipVisible(t){this._tooltipNode.style.opacity=t?"1.0":"0"}}},321:function(t,e,o){var i=this&&this.__createBinding||(Object.create?function(t,e,o,i){void 0===i&&(i=o);var s=Object.getOwnPropertyDescriptor(e,o);s&&("get"in s?e.__esModule:!s.writable&&!s.configurable)||(s={enumerable:!0,get:function(){return e[o]}}),Object.defineProperty(t,i,s)}:function(t,e,o,i){t[i=void 0===i?o:i]=e[o]}),s=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),n=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var o in t)"default"!==o&&Object.prototype.hasOwnProperty.call(t,o)&&i(e,t,o);return s(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.RemoteSelection=void 0;const r=n(o(643)),d=o(422);class a{constructor(t,e,o,i,s,n){this._editor=t,this._id=e;t="monaco-remote-selection-"+o;this._className="monaco-remote-selection "+t,this._styleElement=a._addDynamicStyleElement(t,i),this._label=s,this._decorations=[],this._onDisposed=n}static _addDynamicStyleElement(t,e){d.Validation.assertString(t,"className"),d.Validation.assertString(e,"color");t=`.${t} {
         background-color: ${e};
       }`.trim();const o=document.createElement("style");return o.innerText=t,document.head.appendChild(o),o}static _swapIfNeeded(t,e){return t.lineNumber<e.lineNumber||t.lineNumber===e.lineNumber&&t.column<=e.column?{start:t,end:e}:{start:e,end:t}}getId(){return this._id}getStartPosition(){return Object.assign({},this._startPosition)}getEndPosition(){return Object.assign({},this._endPosition)}setOffsets(t,e){t=this._editor.getModel().getPositionAt(t),e=this._editor.getModel().getPositionAt(e);this.setPositions(t,e)}setPositions(t,e){t=a._swapIfNeeded(t,e);this._startPosition=t.start,this._endPosition=t.end,this._render()}show(){this._render()}hide(){this._decorations=this._editor.deltaDecorations(this._decorations,[])}isDisposed(){return this._disposed}dispose(){this._disposed||(this._styleElement.parentElement.removeChild(this._styleElement),this.hide(),this._disposed=!0,this._onDisposed())}_render(){this._decorations=this._editor.deltaDecorations(this._decorations,[{range:new r.Range(this._startPosition.lineNumber,this._startPosition.column,this._endPosition.lineNumber,this._endPosition.column),options:{className:this._className,hoverMessage:null!=this._label?{value:this._label}:null}}])}}e.RemoteSelection=a},193:(t,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.RemoteSelectionManager=void 0;const i=o(321),s=o(422);e.RemoteSelectionManager=class{constructor(t){s.Validation.assertDefined(t,"options"),this._remoteSelections=new Map,this._options=t,this._nextClassId=0}addSelection(t,e,o){e=new i.RemoteSelection(this._options.editor,t,this._nextClassId++,e,o,()=>{this.removeSelection(t)});return this._remoteSelections.set(t,e),e}removeSelection(t){const e=this._getSelection(t);e.isDisposed()||e.dispose()}setSelectionOffsets(t,e,o){const i=this._getSelection(t);i.setOffsets(e,o)}setSelectionPositions(t,e,o){const i=this._getSelection(t);i.setPositions(e,o)}showSelection(t){const e=this._getSelection(t);e.show()}hideSelection(t){const e=this._getSelection(t);e.hide()}_getSelection(t){if(this._remoteSelections.has(t))return this._remoteSelections.get(t);throw new Error("No such selection: "+t)}}},422:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Validation=void 0;class o{static assertString(t,e){if("string"!=typeof t)throw new Error(e+" must be a string but was: "+t)}static assertNumber(t,e){if("number"!=typeof t)throw new Error(e+" must be a number but was: "+t)}static assertDefined(t,e){if(null==t)throw new Error(e+" must be a defined but was: "+t)}static assertFunction(t,e){if("function"!=typeof t)throw new Error(e+" must be a function but was: "+typeof t)}static assertPosition(t,e){if(o.assertDefined(t,e),"number"!=typeof t.lineNumber||"number"!=typeof t.column)throw new Error(e+" must be an Object like {lineNumber: number, column: number}: "+JSON.stringify(t))}}e.Validation=o},294:function(t,e,o){var i=this&&this.__createBinding||(Object.create?function(t,e,o,i){void 0===i&&(i=o);var s=Object.getOwnPropertyDescriptor(e,o);s&&("get"in s?e.__esModule:!s.writable&&!s.configurable)||(s={enumerable:!0,get:function(){return e[o]}}),Object.defineProperty(t,i,s)}:function(t,e,o,i){t[i=void 0===i?o:i]=e[o]}),s=this&&this.__exportStar||function(t,e){for(var o in t)"default"===o||Object.prototype.hasOwnProperty.call(e,o)||i(e,t,o)};Object.defineProperty(e,"__esModule",{value:!0}),s(o(423),e),s(o(193),e),s(o(22),e)},643:t=>{t.exports=e}},s={};return function t(e){var o=s[e];if(void 0!==o)return o.exports;o=s[e]={exports:{}};return i[e].call(o.exports,o,o.exports,t),o.exports}(294)})());
//# sourceMappingURL=monaco-collab-ext.min.js.map
